trigger:
  - main  # Trigger pipeline on push to 'main' branch

pool:
  name: "Self_Hosted"  # Use a Microsoft-hosted agent

steps:
  - task: UseDotNet@2
    inputs:
      packageType: 'sdk'
      version: '6.x'  # Set to your .NET version
      installationPath: $(Agent.ToolsDirectory)/dotnet

  - task: DotNetCoreCLI@2
    inputs:
      command: 'restore'
      projects: '**/*.csproj'

  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      projects: '**/*.csproj'
      arguments: '--configuration Release'

  - task: DotNetCoreCLI@2
    inputs:
      command: 'publish'
      projects: '**/*.csproj'
      arguments: '--configuration Release --output $(Build.ArtifactStagingDirectory)'

  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: '$(Build.ArtifactStagingDirectory)'
      artifactName: 'drop'

  - task: AzureWebApp@1
    inputs:
      azureSubscription: 'AzureWebAppConnection'
      appName: 'YourAzureWebAppName'
      package: '$(Build.ArtifactStagingDirectory)/*.zip'
      deploymentMethod: 'runFromPackage'
